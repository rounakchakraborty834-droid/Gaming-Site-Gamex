var t=Object.defineProperty,e=(e,s,i)=>(((e,s,i)=>{s in e?t(e,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[s]=i})(e,"symbol"!=typeof s?s+"":s,i),i);import{D as s,x as i,A as n,T as r}from"./dom-component.59802661.js";import{C as o,c as a}from"./index.6c8f1534.js";import{s as l}from"./loader-globals.d8a67046.js";import{s as c}from"./store.4d67c1b5.js";import{R as h}from"./index.d22011ff.js";import{q as u,s as p,aQ as d,V as f,a as m,aR as v,aS as y,aL as g,aT as x,a2 as w,aU as b,aV as S,c as T,ao as k,W as A,d as M,aW as P,g as E,a8 as I,A as C,G as F,b as L,aI as z,l as O,M as R,aC as N,S as D,ai as _}from"./three.module.c9112413.js";import{u as j,p as q,g as U}from"./tweakpane.3236910a.js";import{g as $,s as B}from"./globals.5dc21540.js";import{aB as G,E as W,at as V,aT as H,a$ as Y,x as X}from"./entry.3ad1dc26.js";import{i as J,a as Q,b as Z}from"./gozer-env.ed057cb2.js";import{L as K}from"./LoaderMixin.13fbd445.js";import{a as tt,t as et}from"./index-default.25f36e61.js";import{d as st,m as it}from"./MathUtils.08fed4e9.js";import{a as nt,s as rt,m as ot,e as at}from"./simple-three.1b842056.js";import{L as lt}from"./constants.a4ba8ea6.js";import{l as ct,F as ht}from"./load-font.bdf13add.js";import{T as ut}from"./three-object.b70b8d57.js";import{i as pt}from"./in-range.d69fbb78.js";function dt(t){return t.concat().reverse()}class ft extends u{constructor(t){super(t),this.defaultDPI=90,this.defaultUnit="px"}load(t,e,s,i){const n=this,r=new p(n.manager);r.setPath(n.path),r.setRequestHeader(n.requestHeader),r.setWithCredentials(n.withCredentials),r.load(t,(function(s){try{e(n.parse(s))}catch(r){i&&i(r),n.manager.itemError(t)}}),s,i)}parse(t){const e=this;function s(t,e,s,n,r,o,a,l){if(0==e||0==s)return void t.lineTo(l.x,l.y);n=n*Math.PI/180,e=Math.abs(e),s=Math.abs(s);const c=(a.x-l.x)/2,h=(a.y-l.y)/2,u=Math.cos(n)*c+Math.sin(n)*h,p=-Math.sin(n)*c+Math.cos(n)*h;let d=e*e,f=s*s;const m=u*u,v=p*p,y=m/d+v/f;if(y>1){const t=Math.sqrt(y);d=(e*=t)*e,f=(s*=t)*s}const g=d*v+f*m,x=(d*f-g)/g;let w=Math.sqrt(Math.max(0,x));r===o&&(w=-w);const b=w*e*p/s,S=-w*s*u/e,T=Math.cos(n)*b-Math.sin(n)*S+(a.x+l.x)/2,k=Math.sin(n)*b+Math.cos(n)*S+(a.y+l.y)/2,A=i(1,0,(u-b)/e,(p-S)/s),M=i((u-b)/e,(p-S)/s,(-u-b)/e,(-p-S)/s)%(2*Math.PI);t.currentPath.absellipse(T,k,e,s,A,A+M,0===o,n)}function i(t,e,s,i){const n=t*s+e*i,r=Math.sqrt(t*t+e*e)*Math.sqrt(s*s+i*i);let o=Math.acos(Math.max(-1,Math.min(1,n/r)));return t*i-e*s<0&&(o=-o),o}function n(t,e){e=Object.assign({},e);let s={};if(t.hasAttribute("class")){const e=t.getAttribute("class").split(/\s/).filter(Boolean).map((t=>t.trim()));for(let t=0;t<e.length;t++)s=Object.assign(s,g["."+e[t]])}function i(i,n,r){void 0===r&&(r=function(t){return t.startsWith("url"),t}),t.hasAttribute(i)&&(e[n]=r(t.getAttribute(i))),s[i]&&(e[n]=r(s[i])),t.style&&""!==t.style[i]&&(e[n]=r(t.style[i]))}function n(t){return Math.max(0,Math.min(1,c(t)))}function r(t){return Math.max(0,c(t))}return t.hasAttribute("id")&&(s=Object.assign(s,g["#"+t.getAttribute("id")])),i("fill","fill"),i("fill-opacity","fillOpacity",n),i("fill-rule","fillRule"),i("opacity","opacity",n),i("stroke","stroke"),i("stroke-opacity","strokeOpacity",n),i("stroke-width","strokeWidth",r),i("stroke-linejoin","strokeLineJoin"),i("stroke-linecap","strokeLineCap"),i("stroke-miterlimit","strokeMiterLimit",r),i("visibility","visibility"),e}function r(t,e){return t-(e-t)}function o(t,e,s){if("string"!=typeof t)throw new TypeError("Invalid input: "+typeof t);const i={SEPARATOR:/[ \t\r\n\,.\-+]/,WHITESPACE:/[ \t\r\n]/,DIGIT:/[\d]/,SIGN:/[-+]/,POINT:/\./,COMMA:/,/,EXP:/e/i,FLAGS:/[01]/};let n=0,r=!0,o="",a="";const l=[];function c(t,e,s){const i=new SyntaxError('Unexpected character "'+t+'" at index '+e+".");throw i.partial=s,i}function h(){""!==o&&(""===a?l.push(Number(o)):l.push(Number(o)*Math.pow(10,Number(a)))),o="",a=""}let u;const p=t.length;for(let d=0;d<p;d++)if(u=t[d],Array.isArray(e)&&e.includes(l.length%s)&&i.FLAGS.test(u))n=1,o=u,h();else{if(0===n){if(i.WHITESPACE.test(u))continue;if(i.DIGIT.test(u)||i.SIGN.test(u)){n=1,o=u;continue}if(i.POINT.test(u)){n=2,o=u;continue}i.COMMA.test(u)&&(r&&c(u,d,l),r=!0)}if(1===n){if(i.DIGIT.test(u)){o+=u;continue}if(i.POINT.test(u)){o+=u,n=2;continue}if(i.EXP.test(u)){n=3;continue}i.SIGN.test(u)&&1===o.length&&i.SIGN.test(o[0])&&c(u,d,l)}if(2===n){if(i.DIGIT.test(u)){o+=u;continue}if(i.EXP.test(u)){n=3;continue}i.POINT.test(u)&&"."===o[o.length-1]&&c(u,d,l)}if(3===n){if(i.DIGIT.test(u)){a+=u;continue}if(i.SIGN.test(u)){if(""===a){a+=u;continue}1===a.length&&i.SIGN.test(a)&&c(u,d,l)}}i.WHITESPACE.test(u)?(h(),n=0,r=!1):i.COMMA.test(u)?(h(),n=0,r=!0):i.SIGN.test(u)?(h(),n=1,o=u):i.POINT.test(u)?(h(),n=2,o=u):c(u,d,l)}return h(),l}const a=["mm","cm","in","pt","pc","px"],l={mm:{mm:1,cm:.1,in:1/25.4,pt:72/25.4,pc:6/25.4,px:-1},cm:{mm:10,cm:1,in:1/2.54,pt:72/2.54,pc:6/2.54,px:-1},in:{mm:25.4,cm:2.54,in:1,pt:72,pc:6,px:-1},pt:{mm:25.4/72,cm:2.54/72,in:1/72,pt:1,pc:6/72,px:-1},pc:{mm:25.4/6,cm:2.54/6,in:1/6,pt:12,pc:1,px:-1},px:{px:1}};function c(t){let s,i="px";if("string"==typeof t||t instanceof String)for(let e=0,n=a.length;e<n;e++){const s=a[e];if(t.endsWith(s)){i=s,t=t.substring(0,t.length-s.length);break}}return"px"===i&&"px"!==e.defaultUnit?s=l.in[e.defaultUnit]/e.defaultDPI:(s=l[i][e.defaultUnit],s<0&&(s=l[i].in*e.defaultDPI)),s*parseFloat(t)}function h(t){const e=t.elements;return e[0]*e[4]-e[1]*e[3]<0}function u(t){const e=t.elements,s=e[0]*e[3]+e[1]*e[4];if(0===s)return!1;const i=p(t),n=v(t);return Math.abs(s/(i*n))>Number.EPSILON}function p(t){const e=t.elements;return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function v(t){const e=t.elements;return Math.sqrt(e[3]*e[3]+e[4]*e[4])}const y=[],g={},w=[],b=new d,T=new d,k=new d,A=new d,M=new f,P=new m,E=new d,I=(new DOMParser).parseFromString(t,"image/svg+xml");!function t(e,i){if(1!==e.nodeType)return;const a=function(t){if(!(t.hasAttribute("transform")||"use"===t.nodeName&&(t.hasAttribute("x")||t.hasAttribute("y"))))return null;const e=function(t){const e=new d,s=b;if("use"===t.nodeName&&(t.hasAttribute("x")||t.hasAttribute("y"))){const s=c(t.getAttribute("x")),i=c(t.getAttribute("y"));e.translate(s,i)}if(t.hasAttribute("transform")){const i=t.getAttribute("transform").split(")");for(let t=i.length-1;t>=0;t--){const n=i[t].trim();if(""===n)continue;const r=n.indexOf("("),a=n.length;if(r>0&&r<a){const t=n.slice(0,r),e=o(n.slice(r+1));switch(s.identity(),t){case"translate":if(e.length>=1){const t=e[0];let i=0;e.length>=2&&(i=e[1]),s.translate(t,i)}break;case"rotate":if(e.length>=1){let t=0,i=0,n=0;t=e[0]*Math.PI/180,e.length>=3&&(i=e[1],n=e[2]),T.makeTranslation(-i,-n),k.makeRotation(t),A.multiplyMatrices(k,T),T.makeTranslation(i,n),s.multiplyMatrices(T,A)}break;case"scale":if(e.length>=1){const t=e[0];let i=t;e.length>=2&&(i=e[1]),s.scale(t,i)}break;case"skewX":1===e.length&&s.set(1,Math.tan(e[0]*Math.PI/180),0,0,1,0,0,0,1);break;case"skewY":1===e.length&&s.set(1,0,0,Math.tan(e[0]*Math.PI/180),1,0,0,0,1);break;case"matrix":6===e.length&&s.set(e[0],e[2],e[4],e[1],e[3],e[5],0,0,1)}}e.premultiply(s)}}return e}(t);w.length>0&&e.premultiply(w[w.length-1]);return E.copy(e),w.push(e),e}(e);let l=!1,I=null;switch(e.nodeName){case"svg":case"g":i=n(e,i);break;case"style":!function(t){if(!t.sheet||!t.sheet.cssRules||!t.sheet.cssRules.length)return;for(let e=0;e<t.sheet.cssRules.length;e++){const s=t.sheet.cssRules[e];if(1!==s.type)continue;const i=s.selectorText.split(/,/gm).filter(Boolean).map((t=>t.trim()));for(let t=0;t<i.length;t++){const e=Object.fromEntries(Object.entries(s.style).filter((([,t])=>""!==t)));g[i[t]]=Object.assign(g[i[t]]||{},e)}}}(e);break;case"path":i=n(e,i),e.hasAttribute("d")&&(I=function(t){const e=new S,i=new f,n=new f,a=new f;let l=!0,c=!1;const h=t.getAttribute("d");if(""===h||"none"===h)return null;const u=h.match(/[a-df-z][^a-df-z]*/gi);for(let p=0,d=u.length;p<d;p++){const t=u[p],h=t.charAt(0),d=t.slice(1).trim();let f;switch(!0===l&&(c=!0,l=!1),h){case"M":f=o(d);for(let t=0,s=f.length;t<s;t+=2)i.x=f[t+0],i.y=f[t+1],n.x=i.x,n.y=i.y,0===t?e.moveTo(i.x,i.y):e.lineTo(i.x,i.y),0===t&&a.copy(i);break;case"H":f=o(d);for(let t=0,s=f.length;t<s;t++)i.x=f[t],n.x=i.x,n.y=i.y,e.lineTo(i.x,i.y),0===t&&!0===c&&a.copy(i);break;case"V":f=o(d);for(let t=0,s=f.length;t<s;t++)i.y=f[t],n.x=i.x,n.y=i.y,e.lineTo(i.x,i.y),0===t&&!0===c&&a.copy(i);break;case"L":f=o(d);for(let t=0,s=f.length;t<s;t+=2)i.x=f[t+0],i.y=f[t+1],n.x=i.x,n.y=i.y,e.lineTo(i.x,i.y),0===t&&!0===c&&a.copy(i);break;case"C":f=o(d);for(let t=0,s=f.length;t<s;t+=6)e.bezierCurveTo(f[t+0],f[t+1],f[t+2],f[t+3],f[t+4],f[t+5]),n.x=f[t+2],n.y=f[t+3],i.x=f[t+4],i.y=f[t+5],0===t&&!0===c&&a.copy(i);break;case"S":f=o(d);for(let t=0,s=f.length;t<s;t+=4)e.bezierCurveTo(r(i.x,n.x),r(i.y,n.y),f[t+0],f[t+1],f[t+2],f[t+3]),n.x=f[t+0],n.y=f[t+1],i.x=f[t+2],i.y=f[t+3],0===t&&!0===c&&a.copy(i);break;case"Q":f=o(d);for(let t=0,s=f.length;t<s;t+=4)e.quadraticCurveTo(f[t+0],f[t+1],f[t+2],f[t+3]),n.x=f[t+0],n.y=f[t+1],i.x=f[t+2],i.y=f[t+3],0===t&&!0===c&&a.copy(i);break;case"T":f=o(d);for(let t=0,s=f.length;t<s;t+=2){const s=r(i.x,n.x),o=r(i.y,n.y);e.quadraticCurveTo(s,o,f[t+0],f[t+1]),n.x=s,n.y=o,i.x=f[t+0],i.y=f[t+1],0===t&&!0===c&&a.copy(i)}break;case"A":f=o(d,[3,4],7);for(let t=0,r=f.length;t<r;t+=7){if(f[t+5]==i.x&&f[t+6]==i.y)continue;const r=i.clone();i.x=f[t+5],i.y=f[t+6],n.x=i.x,n.y=i.y,s(e,f[t],f[t+1],f[t+2],f[t+3],f[t+4],r,i),0===t&&!0===c&&a.copy(i)}break;case"m":f=o(d);for(let t=0,s=f.length;t<s;t+=2)i.x+=f[t+0],i.y+=f[t+1],n.x=i.x,n.y=i.y,0===t?e.moveTo(i.x,i.y):e.lineTo(i.x,i.y),0===t&&a.copy(i);break;case"h":f=o(d);for(let t=0,s=f.length;t<s;t++)i.x+=f[t],n.x=i.x,n.y=i.y,e.lineTo(i.x,i.y),0===t&&!0===c&&a.copy(i);break;case"v":f=o(d);for(let t=0,s=f.length;t<s;t++)i.y+=f[t],n.x=i.x,n.y=i.y,e.lineTo(i.x,i.y),0===t&&!0===c&&a.copy(i);break;case"l":f=o(d);for(let t=0,s=f.length;t<s;t+=2)i.x+=f[t+0],i.y+=f[t+1],n.x=i.x,n.y=i.y,e.lineTo(i.x,i.y),0===t&&!0===c&&a.copy(i);break;case"c":f=o(d);for(let t=0,s=f.length;t<s;t+=6)e.bezierCurveTo(i.x+f[t+0],i.y+f[t+1],i.x+f[t+2],i.y+f[t+3],i.x+f[t+4],i.y+f[t+5]),n.x=i.x+f[t+2],n.y=i.y+f[t+3],i.x+=f[t+4],i.y+=f[t+5],0===t&&!0===c&&a.copy(i);break;case"s":f=o(d);for(let t=0,s=f.length;t<s;t+=4)e.bezierCurveTo(r(i.x,n.x),r(i.y,n.y),i.x+f[t+0],i.y+f[t+1],i.x+f[t+2],i.y+f[t+3]),n.x=i.x+f[t+0],n.y=i.y+f[t+1],i.x+=f[t+2],i.y+=f[t+3],0===t&&!0===c&&a.copy(i);break;case"q":f=o(d);for(let t=0,s=f.length;t<s;t+=4)e.quadraticCurveTo(i.x+f[t+0],i.y+f[t+1],i.x+f[t+2],i.y+f[t+3]),n.x=i.x+f[t+0],n.y=i.y+f[t+1],i.x+=f[t+2],i.y+=f[t+3],0===t&&!0===c&&a.copy(i);break;case"t":f=o(d);for(let t=0,s=f.length;t<s;t+=2){const s=r(i.x,n.x),o=r(i.y,n.y);e.quadraticCurveTo(s,o,i.x+f[t+0],i.y+f[t+1]),n.x=s,n.y=o,i.x=i.x+f[t+0],i.y=i.y+f[t+1],0===t&&!0===c&&a.copy(i)}break;case"a":f=o(d,[3,4],7);for(let t=0,r=f.length;t<r;t+=7){if(0==f[t+5]&&0==f[t+6])continue;const r=i.clone();i.x+=f[t+5],i.y+=f[t+6],n.x=i.x,n.y=i.y,s(e,f[t],f[t+1],f[t+2],f[t+3],f[t+4],r,i),0===t&&!0===c&&a.copy(i)}break;case"Z":case"z":e.currentPath.autoClose=!0,e.currentPath.curves.length>0&&(i.copy(a),e.currentPath.currentPoint.copy(i),l=!0)}c=!1}return e}(e));break;case"rect":i=n(e,i),I=function(t){const e=c(t.getAttribute("x")||0),s=c(t.getAttribute("y")||0),i=c(t.getAttribute("rx")||t.getAttribute("ry")||0),n=c(t.getAttribute("ry")||t.getAttribute("rx")||0),r=c(t.getAttribute("width")),o=c(t.getAttribute("height")),a=.448084975506,l=new S;l.moveTo(e+i,s),l.lineTo(e+r-i,s),(0!==i||0!==n)&&l.bezierCurveTo(e+r-i*a,s,e+r,s+n*a,e+r,s+n);l.lineTo(e+r,s+o-n),(0!==i||0!==n)&&l.bezierCurveTo(e+r,s+o-n*a,e+r-i*a,s+o,e+r-i,s+o);l.lineTo(e+i,s+o),(0!==i||0!==n)&&l.bezierCurveTo(e+i*a,s+o,e,s+o-n*a,e,s+o-n);l.lineTo(e,s+n),(0!==i||0!==n)&&l.bezierCurveTo(e,s+n*a,e+i*a,s,e+i,s);return l}(e);break;case"polygon":i=n(e,i),I=function(t){function e(t,e,s){const r=c(e),o=c(s);0===n?i.moveTo(r,o):i.lineTo(r,o),n++}const s=/([+-]?\d*\.?\d+(?:e[+-]?\d+)?)(?:,|\s)([+-]?\d*\.?\d+(?:e[+-]?\d+)?)/g,i=new S;let n=0;return t.getAttribute("points").replace(s,e),i.currentPath.autoClose=!0,i}(e);break;case"polyline":i=n(e,i),I=function(t){function e(t,e,s){const r=c(e),o=c(s);0===n?i.moveTo(r,o):i.lineTo(r,o),n++}const s=/([+-]?\d*\.?\d+(?:e[+-]?\d+)?)(?:,|\s)([+-]?\d*\.?\d+(?:e[+-]?\d+)?)/g,i=new S;let n=0;return t.getAttribute("points").replace(s,e),i.currentPath.autoClose=!1,i}(e);break;case"circle":i=n(e,i),I=function(t){const e=c(t.getAttribute("cx")||0),s=c(t.getAttribute("cy")||0),i=c(t.getAttribute("r")||0),n=new x;n.absarc(e,s,i,0,2*Math.PI);const r=new S;return r.subPaths.push(n),r}(e);break;case"ellipse":i=n(e,i),I=function(t){const e=c(t.getAttribute("cx")||0),s=c(t.getAttribute("cy")||0),i=c(t.getAttribute("rx")||0),n=c(t.getAttribute("ry")||0),r=new x;r.absellipse(e,s,i,n,0,2*Math.PI);const o=new S;return o.subPaths.push(r),o}(e);break;case"line":i=n(e,i),I=function(t){const e=c(t.getAttribute("x1")||0),s=c(t.getAttribute("y1")||0),i=c(t.getAttribute("x2")||0),n=c(t.getAttribute("y2")||0),r=new S;return r.moveTo(e,s),r.lineTo(i,n),r.currentPath.autoClose=!1,r}(e);break;case"defs":l=!0;break;case"use":i=n(e,i);const a=(e.getAttributeNS("http://www.w3.org/1999/xlink","href")||"").substring(1),h=e.viewportElement.getElementById(a);h&&t(h,i)}I&&(void 0!==i.fill&&"none"!==i.fill&&I.color.setStyle(i.fill),function(t,e){function s(t){P.set(t.x,t.y,1).applyMatrix3(e),t.set(P.x,P.y)}function i(t){const s=t.xRadius,i=t.yRadius,n=Math.cos(t.aRotation),r=Math.sin(t.aRotation),o=new m(s*n,s*r,0),a=new m(-i*r,i*n,0),l=o.applyMatrix3(e),c=a.applyMatrix3(e),u=b.set(l.x,c.x,0,l.y,c.y,0,0,0,1),p=T.copy(u).invert(),d=k.copy(p).transpose().multiply(p).elements,f=function(t,e,s){let i,n,r,o,a;const l=t+s,c=t-s,h=Math.sqrt(c*c+4*e*e);l>0?(i=.5*(l+h),a=1/i,n=t*a*s-e*a*e):l<0?n=.5*(l-h):(i=.5*h,n=-.5*h);r=c>0?c+h:c-h;Math.abs(r)>2*Math.abs(e)?(a=-2*e/r,o=1/Math.sqrt(1+a*a),r=a*o):0===Math.abs(e)?(r=1,o=0):(a=-.5*r/e,r=1/Math.sqrt(1+a*a),o=a*r);c>0&&(a=r,r=-o,o=a);return{rt1:i,rt2:n,cs:r,sn:o}}(d[0],d[1],d[4]),v=Math.sqrt(f.rt1),y=Math.sqrt(f.rt2);t.xRadius=1/v,t.yRadius=1/y,t.aRotation=Math.atan2(f.sn,f.cs);if(!((t.aEndAngle-t.aStartAngle)%(2*Math.PI)<Number.EPSILON)){const s=T.set(v,0,0,0,y,0,0,0,1),i=k.set(f.cs,f.sn,0,-f.sn,f.cs,0,0,0,1),n=s.multiply(i).multiply(u),r=t=>{const{x:e,y:s}=new m(Math.cos(t),Math.sin(t),0).applyMatrix3(n);return Math.atan2(s,e)};t.aStartAngle=r(t.aStartAngle),t.aEndAngle=r(t.aEndAngle),h(e)&&(t.aClockwise=!t.aClockwise)}}function n(t){const s=p(e),i=v(e);t.xRadius*=s,t.yRadius*=i;const n=s>Number.EPSILON?Math.atan2(e.elements[1],e.elements[0]):Math.atan2(-e.elements[3],e.elements[4]);t.aRotation+=n,h(e)&&(t.aStartAngle*=-1,t.aEndAngle*=-1,t.aClockwise=!t.aClockwise)}const r=t.subPaths;for(let o=0,a=r.length;o<a;o++){const t=r[o].curves;for(let r=0;r<t.length;r++){const o=t[r];o.isLineCurve?(s(o.v1),s(o.v2)):o.isCubicBezierCurve?(s(o.v0),s(o.v1),s(o.v2),s(o.v3)):o.isQuadraticBezierCurve?(s(o.v0),s(o.v1),s(o.v2)):o.isEllipseCurve&&(M.set(o.aX,o.aY),s(M),o.aX=M.x,o.aY=M.y,u(e)?i(o):n(o))}}}(I,E),y.push(I),I.userData={node:e,style:i});const C=e.childNodes;for(let s=0;s<C.length;s++){const e=C[s];l&&"style"!==e.nodeName&&"defs"!==e.nodeName||t(e,i)}a&&(w.pop(),w.length>0?E.copy(w[w.length-1]):E.identity())}(I.documentElement,{fill:"#000",fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeLineJoin:"miter",strokeLineCap:"butt",strokeMiterLimit:4});return{paths:y,xml:I.documentElement}}static createShapes(t){const e=999999999,s=0,i=1,n=2,r=3,o=4,a=5,l=6,c={loc:s,t:0};function h(t,e,i,r){const o=t.x,a=e.x,l=i.x,h=r.x,p=t.y,d=e.y,f=i.y,m=r.y,v=(h-l)*(p-f)-(m-f)*(o-l),y=(m-f)*(a-o)-(h-l)*(d-p),g=v/y,x=((a-o)*(p-f)-(d-p)*(o-l))/y;if(0===y&&0!==v||g<=0||g>=1||x<0||x>1)return null;if(0===v&&0===y){for(let l=0;l<2;l++){if(u(0===l?i:r,t,e),c.loc==s){const t=0===l?i:r;return{x:t.x,y:t.y,t:c.t}}if(c.loc==n){return{x:+(o+c.t*(a-o)).toPrecision(10),y:+(p+c.t*(d-p)).toPrecision(10),t:c.t}}}return null}for(let n=0;n<2;n++)if(u(0===n?i:r,t,e),c.loc==s){const t=0===n?i:r;return{x:t.x,y:t.y,t:c.t}}return{x:+(o+g*(a-o)).toPrecision(10),y:+(p+g*(d-p)).toPrecision(10),t:g}}function u(t,e,h){const u=h.x-e.x,p=h.y-e.y,d=t.x-e.x,f=t.y-e.y,m=u*f-d*p;if(t.x===e.x&&t.y===e.y)return c.loc=s,void(c.t=0);if(t.x===h.x&&t.y===h.y)return c.loc=i,void(c.t=1);if(m<-Number.EPSILON)return void(c.loc=r);if(m>Number.EPSILON)return void(c.loc=o);if(u*d<0||p*f<0)return void(c.loc=a);if(Math.sqrt(u*u+p*p)<Math.sqrt(d*d+f*f))return void(c.loc=l);let v;v=0!==u?d/u:f/p,c.loc=n,c.t=v}function p(t,e,s){const i=new f;e.getCenter(i);const n=[];return s.forEach((e=>{if(e.boundingBox.containsPoint(i)){(function(t,e){const s=[],i=[];for(let n=1;n<t.length;n++){const r=t[n-1],o=t[n];for(let t=1;t<e.length;t++){const n=h(r,o,e[t-1],e[t]);null!==n&&void 0===s.find((t=>t.t<=n.t+Number.EPSILON&&t.t>=n.t-Number.EPSILON))&&(s.push(n),i.push(new f(n.x,n.y)))}}return i})(t,e.points).forEach((t=>{n.push({identifier:e.identifier,isCW:e.isCW,point:t})}))}})),n.sort(((t,e)=>t.point.x-e.point.x)),n}let d=e,m=-999999999,w=t.subPaths.map((t=>{const s=t.getPoints();let i=-999999999,n=e,r=-999999999,o=e;for(let e=0;e<s.length;e++){const t=s[e];t.y>i&&(i=t.y),t.y<n&&(n=t.y),t.x>r&&(r=t.x),t.x<o&&(o=t.x)}return m<=r&&(m=r+1),d>=o&&(d=o-1),{curves:t.curves,points:s,isCW:v.isClockWise(s),identifier:-1,boundingBox:new y(new f(o,n),new f(r,i))}}));w=w.filter((t=>t.points.length>1));for(let f=0;f<w.length;f++)w[f].identifier=f;const b=w.map((e=>function(t,e,s,i,n){null!=n&&""!==n||(n="nonzero");const r=new f;t.boundingBox.getCenter(r);const o=p([new f(s,r.y),new f(i,r.y)],t.boundingBox,e);o.sort(((t,e)=>t.point.x-e.point.x));const a=[],l=[];o.forEach((e=>{e.identifier===t.identifier?a.push(e):l.push(e)}));const c=a[0].point.x,h=[];let u=0;for(;u<l.length&&l[u].point.x<c;)h.length>0&&h[h.length-1]===l[u].identifier?h.pop():h.push(l[u].identifier),u++;if(h.push(t.identifier),"evenodd"===n){const e=h.length%2==0,s=h[h.length-2];return{identifier:t.identifier,isHole:e,for:s}}if("nonzero"===n){let s=!0,i=null,n=null;for(let t=0;t<h.length;t++){const r=h[t];s?(n=e[r].isCW,s=!1,i=r):n!==e[r].isCW&&(n=e[r].isCW,s=!0)}return{identifier:t.identifier,isHole:s,for:i}}}(e,w,d,m,t.userData?t.userData.style.fillRule:void 0))),S=[];return w.forEach((t=>{if(!b[t.identifier].isHole){const e=new g;e.curves=t.curves;b.filter((e=>e.isHole&&e.for===t.identifier)).forEach((t=>{const s=w[t.identifier],i=new x;i.curves=s.curves,e.holes.push(i)})),S.push(e)}})),S}static getStrokeStyle(t,e,s,i,n){return{strokeColor:e=void 0!==e?e:"#000",strokeWidth:t=void 0!==t?t:1,strokeLineJoin:s=void 0!==s?s:"miter",strokeLineCap:i=void 0!==i?i:"butt",strokeMiterLimit:n=void 0!==n?n:4}}static pointsToStroke(t,e,s,i){const n=[],r=[],o=[];if(0===ft.pointsToStrokeWithBuffers(t,e,s,i,n,r,o))return null;const a=new w;return a.setAttribute("position",new b(n,3)),a.setAttribute("normal",new b(r,3)),a.setAttribute("uv",new b(o,2)),a}static pointsToStrokeWithBuffers(t,e,s,i,n,r,o,a){const l=new f,c=new f,h=new f,u=new f,p=new f,d=new f,m=new f,v=new f,y=new f,g=new f,x=new f,w=new f,b=new f,S=new f,T=new f,k=new f,A=new f;s=void 0!==s?s:12,i=void 0!==i?i:.001,a=void 0!==a?a:0;const M=(t=function(t){let e=!1;for(let n=1,r=t.length-1;n<r;n++)if(t[n].distanceTo(t[n+1])<i){e=!0;break}if(!e)return t;const s=[];s.push(t[0]);for(let n=1,r=t.length-1;n<r;n++)t[n].distanceTo(t[n+1])>=i&&s.push(t[n]);return s.push(t[t.length-1]),s}(t)).length;if(M<2)return 0;const P=t[0].equals(t[M-1]);let E,I,C=t[0];const F=e.strokeWidth/2,L=1/(M-1);let z,O,R,N,D=0,_=!1,j=0,q=3*a,U=2*a;$(t[0],t[1],l).multiplyScalar(F),v.copy(t[0]).sub(l),y.copy(t[0]).add(l),g.copy(v),x.copy(y);for(let f=1;f<M;f++){E=t[f],I=f===M-1?P?t[1]:void 0:t[f+1];const s=l;if($(C,E,s),h.copy(s).multiplyScalar(F),w.copy(E).sub(h),b.copy(E).add(h),z=D+L,O=!1,void 0!==I){$(E,I,c),h.copy(c).multiplyScalar(F),S.copy(E).sub(h),T.copy(E).add(h),R=!0,h.subVectors(I,C),s.dot(h)<0&&(R=!1),1===f&&(_=R),h.subVectors(I,E),h.normalize();const t=Math.abs(s.dot(h));if(t>Number.EPSILON){const s=F/t;h.multiplyScalar(-s),u.subVectors(E,C),p.copy(u).setLength(s).add(h),k.copy(p).negate();const i=p.length(),n=u.length();u.divideScalar(n),d.subVectors(I,E);const r=d.length();switch(d.divideScalar(r),u.dot(k)<n&&d.dot(k)<r&&(O=!0),A.copy(p).add(E),k.add(E),N=!1,O?R?(T.copy(k),b.copy(k)):(S.copy(k),w.copy(k)):W(),e.strokeLineJoin){case"bevel":V(R,O,z);break;case"round":H(R,O),R?G(E,w,S,z,0):G(E,T,b,z,1);break;default:const t=F*e.strokeMiterLimit/i;if(t<1){if("miter-clip"!==e.strokeLineJoin){V(R,O,z);break}H(R,O),R?(d.subVectors(A,w).multiplyScalar(t).add(w),m.subVectors(A,S).multiplyScalar(t).add(S),B(w,z,0),B(d,z,0),B(E,z,.5),B(E,z,.5),B(d,z,0),B(m,z,0),B(E,z,.5),B(m,z,0),B(S,z,0)):(d.subVectors(A,b).multiplyScalar(t).add(b),m.subVectors(A,T).multiplyScalar(t).add(T),B(b,z,1),B(d,z,1),B(E,z,.5),B(E,z,.5),B(d,z,1),B(m,z,1),B(E,z,.5),B(m,z,1),B(T,z,1))}else O?(R?(B(y,D,1),B(v,D,0),B(A,z,0),B(y,D,1),B(A,z,0),B(k,z,1)):(B(y,D,1),B(v,D,0),B(A,z,1),B(v,D,0),B(k,z,0),B(A,z,1)),R?S.copy(A):T.copy(A)):R?(B(w,z,0),B(A,z,0),B(E,z,.5),B(E,z,.5),B(A,z,0),B(S,z,0)):(B(b,z,1),B(A,z,1),B(E,z,.5),B(E,z,.5),B(A,z,1),B(T,z,1)),N=!0}}else W()}else W();P||f!==M-1||Y(t[0],g,x,R,!0,D),D=z,C=E,v.copy(S),y.copy(T)}if(P){if(O&&n){let t=A,e=k;_!==R&&(t=k,e=A),R?(N||_)&&(e.toArray(n,0),e.toArray(n,9),N&&t.toArray(n,3)):!N&&_||(e.toArray(n,3),e.toArray(n,9),N&&t.toArray(n,0))}}else Y(E,w,b,R,!1,z);return j;function $(t,e,s){return s.subVectors(e,t),s.set(-s.y,s.x).normalize()}function B(t,e,s){n&&(n[q]=t.x,n[q+1]=t.y,n[q+2]=0,r&&(r[q]=0,r[q+1]=0,r[q+2]=1),q+=3,o&&(o[U]=e,o[U+1]=s,U+=2)),j+=3}function G(t,e,i,n,r){l.copy(e).sub(t).normalize(),c.copy(i).sub(t).normalize();let o=Math.PI;const a=l.dot(c);Math.abs(a)<1&&(o=Math.abs(Math.acos(a))),o/=s,h.copy(e);for(let l=0,c=s-1;l<c;l++)u.copy(h).rotateAround(t,o),B(h,n,r),B(u,n,r),B(t,n,.5),h.copy(u);B(u,n,r),B(i,n,r),B(t,n,.5)}function W(){B(y,D,1),B(v,D,0),B(w,z,0),B(y,D,1),B(w,z,1),B(b,z,0)}function V(t,e,s){e?t?(B(y,D,1),B(v,D,0),B(w,z,0),B(y,D,1),B(w,z,0),B(k,z,1),B(w,s,0),B(S,s,0),B(k,s,.5)):(B(y,D,1),B(v,D,0),B(b,z,1),B(v,D,0),B(k,z,0),B(b,z,1),B(b,s,1),B(T,s,0),B(k,s,.5)):t?(B(w,s,0),B(S,s,0),B(E,s,.5)):(B(b,s,1),B(T,s,0),B(E,s,.5))}function H(t,e){e&&(t?(B(y,D,1),B(v,D,0),B(w,z,0),B(y,D,1),B(w,z,0),B(k,z,1),B(w,D,0),B(E,z,.5),B(k,z,1),B(E,z,.5),B(S,D,0),B(k,z,1)):(B(y,D,1),B(v,D,0),B(b,z,1),B(v,D,0),B(k,z,0),B(b,z,1),B(b,D,1),B(k,z,0),B(E,z,.5),B(E,z,.5),B(k,z,0),B(T,D,1)))}function Y(t,s,i,r,o,a){switch(e.strokeLineCap){case"round":o?G(t,i,s,a,.5):G(t,s,i,a,.5);break;case"square":if(o)l.subVectors(s,t),c.set(l.y,-l.x),h.addVectors(l,c).add(t),u.subVectors(c,l).add(t),r?(h.toArray(n,3),u.toArray(n,0),u.toArray(n,9)):(h.toArray(n,3),h.toArray(n,9),u.toArray(n,0));else{l.subVectors(i,t),c.set(l.y,-l.x),h.addVectors(l,c).add(t),u.subVectors(c,l).add(t);const e=n.length;r?(h.toArray(n,e-3),u.toArray(n,e-6),u.toArray(n,e-12)):(h.toArray(n,e-6),u.toArray(n,e-3),u.toArray(n,e-12))}}}}}const mt=new ft;let vt=new Map,yt=null,gt=!1;const xt=async(t="/svg/masks.svg")=>{if(yt)return yt;yt=await(async(t,e=(()=>{}))=>new Promise(((s,i)=>{mt.load(t,(t=>s(t)),(t=>e(t)),(t=>i(t)))})))(t);const e=yt.xml.getAttribute("viewBox").split(" ");yt.paths.forEach((t=>{const s=t.userData.node.id;t.viewbox=e,vt.set(s,t)})),gt=!0},wt=t=>{if(!gt)return null;const e=vt.get(t);return e||null},bt="/images/compressed/ktx/",St="/images/compressed/webp/",Tt="/gltf/compressed/etc1s/",kt={useCompressed:!0,prerenderScenes:!0,compressionExt:"ktx",textureSize:J?"1024":"2048",gltfBaseFolder:Tt,hasMobileFallback:Q,ktxBase:bt,webpBase:St},At=class extends o{constructor(){super(...arguments),e(this,"assets",kt.hasMobileFallback?{flickTexture:`${St}tableau/flick.webp#texture`,noiseTexture:`${St}tableau/extras/noise.webp#texture`}:{noiseTexture:`${St}tableau/extras/noise.webp#texture`,flickTexture:`${St}tableau/extras/flick.webp#texture`,mapPNoise:`${bt}tableau/extras/pnoise0.ktx2`})}async onSetup(){At.instance=this,At.assets=this.assets}};let Mt=At;e(Mt,"instance"),tt(Mt,[K()]);const Pt=({options:t,props:e})=>i`<div class="placeholderShell">
    <div class="placeholderShell__header"></div>
    <div class="placeholderShell__sideNav"></div>
  </div>`;class Et extends o{constructor(){super(...arguments),e(this,"options",{template:Pt})}}tt(Et,[s]),a("postResize");const It=Z?"deviceTablet":Q?"devicePhone":"deviceDesktop",Ct=({options:t,props:e})=>i`<div class="root ${It} ${""}">
  <div data-ui="viewport" class="viewport"></div>
  <div data-ui="gl" class="gl"></div>
  <div data-ui="ui" class="ui"></div>
  <div data-ui="wrapper" class="wrapper">
    <div data-ui="content">
      <!--- ALL YOUR CONTENT HERE --->
    </div>
  </div>
</div>`;class Ft extends o{constructor(){super(...arguments),e(this,"options",{template:Ct,page:null}),e(this,"props",{counter:0,name:"Hello Props",active:!0,scrollPaused:()=>c().state.scrollPaused,hideShell:()=>c().state.hideShell}),e(this,"scroll",0),e(this,"scrollTg",0),e(this,"handleResize",(()=>{const{clientWidth:t,clientHeight:e}=document.documentElement,s=this.ui.viewport.clientHeight||e;t===c().state.vw&&e===c().state.vh&&s===c().state.vh100||(document.body.style.setProperty("--100ui",`${e}px`),document.body.style.setProperty("--100vh",`${s}px`)),c().state.vw=t,c().state.vh=e,c().state.vh100=s})),e(this,"handlePointDown",(()=>{c().state.pointer.down=!0})),e(this,"handlePointUp",(()=>{c().state.pointer.down=!1})),e(this,"handleScroll",(()=>{this.scrollTg=scrollY}))}async onSetup(){var t;this.setupContainerGlobals(),this.computeAppProps(),await this.addRenderer();const[e,s]=await Promise.all([xt(),this.addGlobalAssets()]);this.globalAssets=s,await this.addComponent(),null==(t=$.scrollSmoother)||t.refresh(),this.handleResize=G(this.handleResize,500),this.handleResize(),window.globals=$,window.store=c()}setupContainerGlobals(){B({canvasContainer:document.getElementById("canvas-container"),uiContainer:document.getElementById("ui-container")})}computeAppProps(){const{app:t}=$;this.stopHoverWatch=W((()=>t.hovering),(t=>{c().state.appHovering=t})),this.stopActiveSectionWatch=W((()=>t.activeSection),(t=>{c().state.activeSection=t}))}async setupSandboxFeatures(){this.setupScrolling(),j.get("clipContent")&&document.body.classList.add("clipContent"),this.shell=await(new Et).setup({options:{insertBefore:this.ui.gl}})}setupScrolling(){const{ScrollSmoother:t,scrollSmoother:e}=$;if(!e&&!J){const e=t.create({wrapper:this.ui.wrapper,content:this.ui.content,smoothTouch:!0,smooth:J?.2:.8,effects:!1});B({scrollSmoother:e}),e.paused(!0)}}setScrollPaused(t){$.app.toggleScrollerPause(t)}setHideShell(t){Q?window.TheNavMobile&&(window.TheNavMobile.data.opacity=0|!t):$.app.simpleFrame.opacity=0|!t}async addGlobalAssets(){return(new Mt).setup()}async addComponent(){const{component:t}=this.options;t&&(this.component=await(new t).setup({options:{appendTo:this.ui.content}}))}async addRenderer(){this.renderer=await(new h).setup({options:{appendTo:$.canvasContainer},props:{width:1,height:1,pr:.7}}),l({GLOBAL_RENDERER:this.renderer.renderer})}onAfterSetup(){this.addEvents()}addEvents(){addEventListener("resize",this.handleResize),document.addEventListener("pointerdown",this.handlePointDown),document.addEventListener("pointerup",this.handlePointUp),$.scrollSmoother||document.addEventListener("scroll",this.handleScroll)}removeEvents(){removeEventListener("resize",this.handleResize),document.removeEventListener("pointerdown",this.handlePointDown),document.removeEventListener("pointerup",this.handlePointUp),$.scrollSmoother||document.removeEventListener("scroll",this.handleScroll)}onActive(){var t;null==(t=this.component)||t.show()}whileActive(){var t,e,s,i,n;null==(e=null==(t=q)?void 0:t.fps)||e.begin(),this.updateScroll(),this.renderer.render(),null==(s=this.component)||s.render(),null==(n=null==(i=q)?void 0:i.fps)||n.end()}updateScroll(){var t;const{scrollSmoother:e}=$,{vh:s}=c().state,{delta:i}=h.getInstance();if(e){if(this.scrollTg=e.scrollTop()||scrollY,this.scroll===this.scrollTg)return;this.scroll=this.scrollTg}else{const t=J?8:4;if(this.scroll+=.1*(this.scrollTg-this.scroll),this.scroll=st(this.scroll,this.scrollTg,t,i),this.scroll===this.scrollTg)return}null==(t=this.component)||t.setScroll(this.scroll),c().state.scroll=this.scroll,c().state.belowFold=this.scroll>s,Math.abs(this.scroll-this.scrollTg)<.05&&(this.scroll=this.scrollTg)}onBeforeDestroy(){}onDestroy(){this.removeEvents(),this.stopHoverWatch(),this.stopActiveSectionWatch()}}function Lt(t){return t*Math.PI/180}tt(Ft,[s]);const zt=new Map,Ot=t=>{const e=zt.get(t);if(e)return e};new m,new T,new k;const Rt=async t=>new Promise((e=>{setTimeout(e,t)})),Nt=new A(1,1),Dt=new M,_t=new P,jt=async(t,e,s)=>{const i=s||h.getRenderer(),n=[];e.traverse((t=>{t instanceof E&&n.push(t)}));let r=0;for(let o=0;o<n.length;o+=1){r+=qt(t,i,n[o]),r>=8&&(r=0,await Rt(100))}},qt=(t,e,s)=>{const i=e||h.getRenderer();i.setRenderTarget(Nt),i.clear(),i.info.programs.length,i.info.memory.geometries;const n=s.frustumCulled;s.frustumCulled=!1;const r=s.parent;Dt.add(s);const o=Date.now();i.render(Dt,_t),i.setRenderTarget(null);const a=Date.now()-o;return s.frustumCulled=n,r&&r.add(s),a},Ut={options:{id:"defaultId",stStart:"top bottom",stEnd:"bottom top",pinSpacing:!1,setVisOnIntersection:!0},props:{viewport:()=>c().state.viewport,enter:!1,progress:0,time:0,top:0,start:0,end:1/0,domLoaded:()=>c().state.domLoaded,bounds:{width:1,height:1}},onSetup(){var t,e;this.triggerEl=this.options.triggerEl||this.el,t=this.options.id,e=this,zt.set(t,e)},onAfterSetup(){this.el.style.opacity=1},setupScrollTrigger(){var t;const{id:e,stStart:s,stEnd:i,pinSpacing:n}=this.options,{ScrollTrigger:r}=$;null==(t=this.st)||t.kill(),this.st=r.create({id:e,trigger:this.triggerEl,start:s,end:i,pin:this.pinEl,pinSpacing:n,onEnter:()=>{this.props.enter=!0},onEnterBack:()=>{this.props.enter=!0},onLeave:()=>{this.props.enter=!1},onLeaveBack:()=>{"landing"==this.options.id&&window.scrollY<=0||(this.props.enter=!1)}}),this.props.start=this.st.start,this.props.end=this.st.end},setupTimeline(){},addHelpers(){var t;const e=new I,s=new C(1),i=new F(100,100),n=new L(this.camera),r=this.meshRef=new E(new z(.05,.05,.05),nt());e.add(s),e.add(i),e.add(n),e.add(r),e.traverse((t=>{t!==e&&(t.layers.set(lt.MAIN),t.material.depthWrite=t.material.depthTest=!1,t.material.transparent=!0,t.renderOrder=99)})),null==(t=this.scene)||t.add(e)},preResize(){},resize({height:t}){const{scrollSmoother:e}=$,s=this.triggerEl.getBoundingClientRect(),i=e?e.scrollTop():c().state.scroll;this.props.top=s.top+i,this.props.bounds={width:s.width,height:s.height},this.setupScrollTrigger()},onEnter(){this.options.setVisOnIntersection&&(this.el.style.pointerEvents="auto",this.el.style.visibility="visible")},offEnter(){this.options.setVisOnIntersection&&(this.el.style.pointerEvents="none",this.el.style.visibility="hidden")},whileEnter(){const{scroll:t}=c().state,{start:e,end:s}=this.props,{debug:i}=this.options;i||(this.props.progress=it(t,e,s,0,1,!0),this.props.time=Math.max(0,t-this.props.start))},render(){},onDestroy(){var t;null==(t=this.st)||t.kill()}},$t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";class Bt extends o{constructor(){super(...arguments),e(this,"options",{el:null}),e(this,"props",{active:!1}),e(this,"targetText",""),e(this,"targetLines",[]),e(this,"finalText",""),e(this,"totalLength",0),e(this,"glitchTrailLength",2),e(this,"animationSpeed",1),e(this,"animObject",{inLine:0,at:0,glitch:0,lines:[]}),e(this,"writeIn",(()=>{const{animObject:t,targetLines:e}=this;let s=Math.floor(t.at);for(let n in e){const i=e[n];t.lines[n]=i.substring(0,s),s-=i.length}let i=Math.floor(t.glitch);for(let n in t.lines){let e=t.lines[n];const s=i-e.length,r=Math.max(0,-s);e=e.substring(0,e.length-r);for(let t=0;t<r-1;t++){const t=Math.floor(52*Math.random()-1);e+=$t.substring(t,t+1)}t.lines[n]=e}this.finalText=t.lines.join("\n"),this.setFinalText(this.finalText)}))}async onSetup(){this.el=this.options.el,this.el.style.contain="content",this.setupText()}setupText(){this.targetText=this.el.innerText,this.targetLines=this.targetText.split("\n");for(let s of this.targetLines)this.totalLength+=s.length;const t=document.createElement("span");this.animatedText=document.createElement("span");const e=window.getComputedStyle(this.el).position;t.style.opacity=0,"absolute"!==e&&(this.el.style.position="relative"),Object.assign(this.animatedText.style,{top:0,left:0,maxWidth:"100%",position:"absolute"}),t.innerHTML=this.el.innerHTML,this.el.innerHTML="",this.el.appendChild(this.animatedText),this.el.appendChild(t),this.setFinalText("")}animateGlitch(t=1,e=0){const{animObject:s,totalLength:i,glitchTrailLength:n,animationSpeed:r}=this;V.killTweensOf(s,"glitch"),V.fromTo(s,{glitch:0},{glitch:i,onUpdate:this.writeIn,ease:"linear",delay:e,duration:(.04*i+.2*n)*r*t})}animateWriteIn(t=1,e=0){const{animObject:s,totalLength:i,glitchTrailLength:n,animationSpeed:r}=this,o=.04*i*r*t;return this.setFinalText(""),V.killTweensOf(s,"at"),V.fromTo(s,{at:0},{at:i,ease:"linear",duration:.04*i*r*t,delay:e}),o}animateWriteOut(t=1,e=0){const{animObject:s,totalLength:i,glitchTrailLength:n,animationSpeed:r}=this,o=.04*i*r*t;V.killTweensOf(s),V.to(s,{at:0,ease:"linear",onUpdate:this.writeIn,duration:o,delay:e})}setFinalText(t){this.animatedText.innerText=t}reset(){V.killTweensOf(this.animObject),this.setFinalText("")}show({delay:t=0,speed:e=1}={}){const s=this.animateWriteIn(e,t);return this.animateGlitch(e,t),s}hide({delay:t=0,speed:e=1}={}){this.props.active=!1,this.animateWriteOut(e,t)}}class Gt extends o{constructor(){super(...arguments),e(this,"options",{vLookAt:new m,vPos:new m(0,0,1),distOrbit:.1*Math.PI,log:!1,name:"Camera Alt"}),e(this,"props",{viewport:()=>c().state.viewport,disableInteraction:!1,maxRotation:10,fov:24,zoom:1,xOffset:0,yOffset:0,offset:t=>({x:t.xOffset,y:t.yOffset})}),e(this,"theta",0),e(this,"phi",0),e(this,"tweenProps",{xOffset:0,yOffset:0})}updateTweenProps(){this.props.xOffset=this.tweenProps.xOffset,this.props.yOffset=this.tweenProps.yOffset}async onSetup(){this.options,this.props,this.camera=new O(32,1,.01,100),this.camera.position.set(0,0,2),this.pointer=H()}whileActive(){this.update()}update(){const{delta:t}=h.getInstance(),{vw:e,vh:s}=c().state,{vLookAt:i,vPos:n}=this.options,{maxRotation:r,disableInteraction:o}=this.props,{x:a,y:l}=this.pointer;!this.pointerStarted&&a.value&&(this.pointerStarted=!0);const u=this.pointerStarted?a.value:e/2,p=this.pointerStarted?l.value:s/2,d=Lt(r),f=n.distanceTo(i),v=it(u,0,e,d,-d),y=it(p,0,s,d,-d),g=.5*Math.PI;o||(this.theta=R.damp(this.theta,v,3,t),this.phi=R.damp(this.phi,y,3,t));const x=(new m).setFromSphericalCoords(f,this.phi+g,this.theta).add(i);this.camera.position.copy(x),this.camera.lookAt(this.options.vLookAt)}setFov(t){this.camera.fov=t,this.camera.updateProjectionMatrix()}setZoom(t){this.camera.zoom=t,this.camera.updateProjectionMatrix()}setOffset({x:t,y:e}){const{vw:s,vh:i,vh100:n}=c().state;this.camera.setViewOffset(s,n,t,e,s,n),this.camera.updateProjectionMatrix()}setViewport({width:t,height:e,height100vh:s}){this.camera.aspect=t/s,this.camera.updateProjectionMatrix()}}
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Wt=2;class Vt{constructor(t){}get _$AU(){return this._$AM._$AU}_$AT(t,e,s){this._$Ct=t,this._$AM=e,this._$Ci=s}_$AS(t,e){return this.update(t,e)}update(t,e){return this.render(...e)}}
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */class Ht extends Vt{constructor(t){if(super(t),this.et=n,t.type!==Wt)throw Error(this.constructor.directiveName+"() can only be used in child bindings")}render(t){if(t===n||null==t)return this.ft=void 0,this.et=t;if(t===r)return t;if("string"!=typeof t)throw Error(this.constructor.directiveName+"() called with a non-string value");if(t===this.et)return this.ft;this.et=t;const e=[t];return e.raw=e,this.ft={_$litType$:this.constructor.resultType,strings:e,values:[]}}}Ht.directiveName="unsafeHTML",Ht.resultType=1;const Yt=(Xt=Ht,(...t)=>({_$litDirective$:Xt,values:t}));var Xt;const Jt=({options:t,props:e})=>i`<div class="caption type-caption2 ${t.textClass}">
  <div data-ui="dot" class="caption__dot"></div>
  <p data-ui="text" class="caption__text">
    ${Yt(t.text)}
  </p>
</div>`;class Qt extends o{constructor(){super(...arguments),e(this,"options",{template:Jt,text:"Caption Text",textClass:"type-caption2"}),e(this,"props",{active:!1,fontLoaded:!1}),e(this,"onShowComplete",(()=>{for(let t=0;t<11;t++){const e=t%2==0?1:0,s=.5*t;V.set(this.ui.dot,{alpha:e,delay:s})}}))}async onSetup(){this.loadFont()}loadFont(){ct({fontface:"IBMPlexMono"}).then((()=>{this.updateText(this.options.text),this.props.fontLoaded=!0}))}updateText(t){var e;null==(e=this.split)||e.revert(),this.text=t.replace(/(?:\r\n|\r|\n)/g,"<br>"),this.ui.text.innerHTML=this.text,this.setupText()}setupText(){this.split=new Y(this.ui.text,{type:"chars"}),this.charsInverse=this.split.chars.slice().reverse(),this.props.active||(V.set(this.split.chars,{alpha:0}),V.set(this.ui.dot,{alpha:0}))}show({delay:t=0,stagger:e=.02}={}){this.props.active=!0,V.killTweensOf(this.split.chars),V.killTweensOf(this.ui.dot),V.set(this.ui.dot,{alpha:1,delay:t}),this.showTween=V.to(this.split.chars,{alpha:1,duration:0,stagger:e,delay:t,onComplete:this.onShowComplete})}hide({delay:t=0,stagger:e=.01}={}){var s;this.props.active=!1,null==(s=this.showTween)||s.kill(),V.killTweensOf(this.ui.dot),this.split&&V.killTweensOf(this.split.chars),V.set([this.ui.dot],{alpha:0,delay:t}),V.to(this.charsInverse,{alpha:0,duration:0,stagger:e,delay:t})}}tt(Qt,[s]);const Zt=({options:t,props:e})=>i` <div class="title1 ${t.className}">
    <div
      data-ui="caption"
      class="title1__caption"
    ></div>
    <h2
      data-ui="title"
      class="title1__text type-h1"
    >
      <span class="spacer">&nbsp;</span>
      ${t.text}
    </h2>
  </div>`;class Kt extends o{constructor(){super(...arguments),e(this,"options",{template:Zt,text:"Lorem ipsum dolor, sit amet consectetur adipisicing elit. Nemo, voluptates!",caption:"Caption Text",className:"",showOnSetup:!0}),e(this,"props",{fontLoaded:!1,viewport:c().state.viewport})}get lines(){return this.splitText.lines}async onSetup(){this.setupTitle(),await this.setupCaption(),this.loadFont()}loadFont(){new ht("ABCWhytePlus",{}).load(null,5e3).then((()=>{this.setupTitle(),this.props.fontLoaded=!0}),(()=>{}))}setupTitle(){var t;null==(t=this.splitText)||t.revert();let e=this.options.text.replace(/(?:\r\n|\r|\n)/g,"<br>");e='<span class="spacer">&nbsp;</span>'+e,this.ui.title.innerHTML=e,this.splitText=new Y(this.ui.title,{type:"lines",linesClass:"line"})}async setupCaption(){const{showOnSetup:t,caption:e}=this.options;this.caption=await(new Qt).setup({options:{appendTo:this.ui.caption,text:e},props:{active:t}})}show({delay:t=0,stagger:e=.02}={}){}hide({delay:t=0,stagger:e=.01}={}){}setViewport(){this.props.fontLoaded&&this.setupTitle()}}tt(Kt,[s]);const te=(t="top",e="",s="dark")=>i`<hr class="js-line  line--${t} ${e} ${s}"></hr>`;function ee(t){const e=document.createElement("div");return e.innerHTML=t,e.firstChild}const se=({context:t,options:e})=>i` <button class="btnMain type-btn ${e.textClass}"
    @pointerenter=${t.onRollover}
    @pointerleave=${t.offRollover}>
    <a class="btnMain__link" href="${e.link}"
    data-ui="main"
    @click=${t.onLinkClick}></a>
    <svg viewBox="0 0 0 0" fill="none"  data-ui="svg" class="btnMain__svg" width=10 height=10 xmlns="http://www.w3.org/2000/svg">
      <path d="M 10 10 C 20 20, 40 20, 50 10" class="btnMain__path"/>
    </svg>

    <span data-ui="dot" class="btnMain__dot"></span>
    <span data-ui="text" class="btnMain__text">${Yt(e.text)}</p>
    
  </button>`;class ie extends o{constructor(){super(...arguments),e(this,"options",{template:se,text:"Btn Main",textClass:"BtnMain1",link:"/",external:!1,cbClick:null}),e(this,"props",{active:!1}),e(this,"onRollover",(()=>{V.killTweensOf(this.drawProps),this.initSVG(),V.to(this.drawProps,{cornerCutSize:0,ease:"quint.out",duration:.4,onUpdate:this.drawButton.bind(this)}),this.hackyText.show(),this.sound.play()})),e(this,"offRollover",(()=>{V.killTweensOf(this.drawProps),V.to(this.drawProps,{cornerCutSize:this.cutCornerRadius,ease:"quint.out",duration:.4,onUpdate:this.drawButton.bind(this)})})),e(this,"onLinkClick",(t=>{this.options.cbClick&&(t.preventDefault(),this.options.cbClick())}))}async onSetup(){this.cutCornerRadius=12,this.drawProps={height:0,width:0,dropdown:0,cornerCutSize:0},this.initSVG(),V.set(this.path,{drawSVG:0}),this.hackyText=await(new Bt).setup({options:{el:this.ui.text}}),this.sound=new X.Howl({src:["/audio/UI_menu_text_rollover.mp3"],volume:2}),this.props.active||V.set(this.ui.dot,{alpha:0})}show({delay:t=0,stagger:e=.02}={}){this.props.active=!0,this.hackyText.show(),V.killTweensOf(this.ui.dot),V.set(this.ui.dot,{alpha:1,delay:t}),V.killTweensOf(this.path),V.fromTo(this.path,{drawSVG:0},{duration:1,ease:"quint.inOut",drawSVG:"100%"})}initSVG(){this.drawProps.width==parseFloat(this.ui.svg.clientWidth)&&this.drawProps.height==parseFloat(this.ui.svg.clientHeight)||(this.path=this.ui.svg.querySelector(".btnMain__path"),this.drawProps.width=parseFloat(this.ui.svg.clientWidth),this.drawProps.height=parseFloat(this.ui.svg.clientHeight),this.ui.svg.setAttribute("width",this.drawProps.width+"px"),this.ui.svg.setAttribute("height",this.drawProps.height+"px"),this.ui.svg.setAttribute("viewBox","0 0 "+this.drawProps.width+" "+this.drawProps.height),V.to(this.drawProps,{cornerCutSize:this.cutCornerRadius,ease:"quint.inOut",duration:1,onUpdate:this.drawButton.bind(this)}),this.drawButton())}drawButton(){let t="";const e=this.drawProps,s=e.cornerCutSize,i=e.width,n=e.height*(1+e.dropdown);t+=this.getPathString("M",0,4,0,0,5,0),t+=this.getPathString("L",i-4,0,i,0,i,4),s>4?(t+=this.getPathString("L",i,n-s-2,i-0,n-s-1,i-2,n-s+2),t+=this.getPathString("L",i-s+4,n-4,i-s+1,n-1,i-s-2,n)):t+=this.getPathString("L",i,n-4,i,n,i-4,n),t+=this.getPathString("L",4,n,0,n,0,n-4),t+="L 0 4",this.path.setAttribute("d",t)}getPathString(t,e,s,i,n,r,o){return t+" "+e+" "+s+" Q "+i+" "+n+", "+r+" "+o}hide({delay:t=0,stagger:e=.01}={}){this.props.active=!1,V.killTweensOf(this.ui.dot),V.killTweensOf(this.path),V.set([this.ui.dot],{alpha:0,delay:t}),V.to(this.path,{duration:3,ease:"quint.inOut",drawSVG:"0%"})}}tt(ie,[s]);const ne=({options:t,props:e})=>i`<video
    class="transparentVideo ${t.className}"
    ?poster="${t.poster}"
    ?loop="${t.loop}"
    playsinline
    muted
  >
    <source
      src="${t.src}${t.browserPrefix?"-hevc-safari":""}.mp4"
      type='video/mp4; codecs="hvc1"'
    />
    <source
      src="${t.src}${t.browserPrefix?"-vp9-chrome":""}.webm"
      type="video/webm"
    />
  </video>`;class re extends o{constructor(){super(...arguments),e(this,"options",{template:ne,className:"",loop:!0,poster:null,browserPrefix:!0,src:"/videos/collection/OBJECT-FX_001_CLEAN_1"}),e(this,"props",{active:!1})}async onSetup(){}onActive(){this.el.play()}offActive({firsrTrigger:t}){t||this.el.pause()}}tt(re,[s]);const oe="#define GLSLIFY 1\nvec3 gammaCorrect(vec3 color,float gamma){return pow(color,vec3(1.0/gamma));}vec3 levelRange(vec3 color,float minInput,float maxInput){return min(max(color-vec3(minInput),vec3(0.0))/(vec3(maxInput)-vec3(minInput)),vec3(1.0));}vec3 levels(vec3 color,float minInput,float gamma,float maxInput){return gammaCorrect(levelRange(color,minInput,maxInput),gamma);}";class ae extends o{constructor(){super(...arguments),e(this,"options",{}),e(this,"props",{})}async onSetup(){const{gltfRef:t,maxLayers:e}=this.options,s=this.mesh=t,{order:i}=s.userData,n=s.material.map;n&&(n.encoding=N),s.matrixAutoUpdate=!1,s.layers.set(lt.MAIN),s.updateMatrix(),s.material=new D({vertexShader:rt,fragmentShader:"\n        varying vec2 vUv;\n        uniform sampler2D tMap;\n        void main() {\n            vec4 tDiffuse = texture2D(tMap, vUv);\n            float a = tDiffuse.a;\n            vec3 color = tDiffuse.rgb;\n            gl_FragColor = vec4(color, a);\n        }",uniforms:{tMap:{value:n}},transparent:!0}),i&&(s.material.depthWrite=s.material.depthTest=!1,s.renderOrder=e-i)}}tt(ae,[ut]);class le{constructor(t,e){this.handler=e,this.fps=t,this.interval=1e3/this.fps,this.then=Date.now(),this.now=0,this.elapsed=0,this.delta=0,this.startTime=this.then}tick(){this.now=Date.now(),this.delta=this.now-this.then,this.step=Math.round(this.delta/(1e3/this.fps)),this.delta>this.interval&&(this.then=this.now-this.delta%this.interval,this.elapsed+=this.delta/1e3,this.handler&&this.handler(this.delta,this.elapsed,this.step))}destroy(){this.handler=null}}class ce{constructor(t,s=60,i=(()=>{}),n=(()=>{}),r=!1){e(this,"onFrame"),e(this,"onEnd"),e(this,"autoUpdate"),e(this,"fps"),e(this,"totalFrames"),e(this,"endFrame"),e(this,"range"),e(this,"ticker"),e(this,"range"),e(this,"direction",1),e(this,"currentFrame",0),e(this,"currentLoop",0),e(this,"maxLoops",0),e(this,"currentIndex",0),e(this,"startFrame",0),e(this,"isPaused",!0),e(this,"isEnded",!1),e(this,"isFirstTick",!1),e(this,"isTicking",!1),e(this,"autoReverse",!1),e(this,"isInfiniteLoop",!1),e(this,"onTick",((t,e,s)=>{const{isFirstTick:i}=this;if(this.isFirstTick=!1,!i){if(!pt(this.currentIndex+s,0,this.range.length)&&(this.currentLoop+=1,this.currentLoop===this.maxLoops&&!this.isInfiniteLoop))return void this.end();this.updateFrame(s)}this.onFrame(this.currentFrame)})),this.onFrame=i,this.onEnd=n,this.autoUpdate=r,this.fps=s,this.totalFrames=t,this.endFrame=t-1,this.range=this.createRangeFromState()}play(t,e,s,i=!1,n=!1){if(!pt(e,0,this.totalFrames))throw new Error("Start frame is out of bounds");if(!pt(s,0,this.totalFrames))throw new Error("End frame is out of bounds");this.isPaused=!1,this.isEnded=!1,this.maxLoops=t,this.startFrame=e,this.endFrame=s,this.autoReverse=i,this.currentFrame=e,this.currentLoop=0,this.direction=n?1:e>s?-1:1,this.range=this.createRangeFromState(),this.currentIndex=0,this.isInfiniteLoop=0===t,this.isFirstTick=!0,this.startTicker()}reverse(){if(this.isEnded)return;const t=this.startFrame,e=this.currentIndex<=.5*this.range.length;this.startFrame=this.endFrame,this.endFrame=t,this.direction*=-1,this.range=this.createRangeFromState(),this.currentIndex=e?this.range.indexOf(this.currentFrame):this.range.lastIndexOf(this.currentFrame)}pause(){this.isFirstTick=!1,this.isPaused=!0,this.stopTicker()}pauseAtFrame(t){if(!pt(t,0,this.totalFrames))throw new Error("Frame is out of bounds")}resume(){this.isPaused&&!this.isEnded&&(this.isPaused=!1,this.startTicker())}setFPS(t){t!==this.fps&&(this.fps=t,this.isTicking&&(this.stopTicker(),this.startTicker()))}update(){this.isTicking&&!this.autoUpdate&&this.ticker.tick()}getCurrentFrame(){return this.currentFrame}startTicker(){this.isTicking||(this.isTicking=!0,this.ticker=new le(this.fps,this.onTick))}stopTicker(){this.isTicking&&(this.isTicking=!1,this.ticker.destroy(),this.ticker=null)}tick(){this.ticker.tick()}goToFrame(t){this.currentIndex=t,this.currentFrame=this.range[this.currentIndex],this.onFrame(this.currentFrame)}updateFrame(t){this.currentIndex=(this.currentIndex+t)%this.range.length,this.currentFrame=this.range[this.currentIndex]}end(){this.stopTicker();const t=this.currentIndex;this.currentIndex=this.range.length-1,t!==this.currentIndex&&(this.currentFrame=this.range[this.currentIndex],this.onFrame(this.currentFrame)),this.isEnded=!0,this.onEnd()}createRangeFromState(){return function(t,e,s,i,n){let r=n;void 0===r&&(r=e<s?1:-1);let o=function(t){const e=[];for(let s=0;s<t;s+=1)e.push(s);return e}(t);o=-1===r?dt(o):o;const a=o.indexOf(e),l=o.indexOf(s);return o=function(t,e,s){let i=t;return i=e>=s?i.slice(e).concat(i.slice(0,s)):i.slice(e,s),i}(o,a,l+1),o=i?o.concat(dt(o.slice(1,-1))):o,o}(this.totalFrames,this.startFrame,this.endFrame,this.autoReverse,this.direction)}}const he=(t,e=1)=>t.reduce(((t,s)=>t.concat(e>1&&Array.isArray(s)?he(s,e-1):s)),[]),ue=(t,e)=>{e.w>e.h?t.scale.set(t.scale.x,t.scale.x*(e.h/e.w)):t.scale.set(t.scale.y*(e.w/e.h),t.scale.y)},pe={options:{fps:30,data:[{json:null,texture:null}],sequences:[{id:"seq-1",from:0,to:2}],onFrame:()=>{},onEnd:()=>{}},props:{},frames:[],currentFrame:null,async onSetup(){await this.setupFrames(),await this.setupSequence()},async setupFrames(){const{data:t}=this.options;this.frames=(t=>{const e=he((Array.isArray(t)?t:[t]).map((t=>{const{texture:e,json:s}=t;return Object.entries(s.frames).map((t=>({id:t[1].filename,atlas:e,atlasData:s,frame:t[1].frame,spriteSourceSize:t[1].spriteSourceSize,sourceSize:t[1].sourceSize,size:s.meta.size})))})),1);return Array.isArray(t)&&t.length>1?e.sort(((t,e)=>t.id.localeCompare(e.id))):e})(t),this.currentFrame=this.frames[0]},async setupSequence(){this.sequence=new ce(this.frames.length,this.options.fps,this.onFrame.bind(this),this.onEnd.bind(this))},onFrame(t){this.currentFrame=this.frames[t],this.options.onFrame(this.currentFrame)},onEnd(){this.options.onEnd(this.sequenceId)},playSequence(t){const{sequences:e}=this.options,s=e.find((e=>e.id===t));if(!s)return;const i=void 0!==s.loop?s.loop:1;this.sequenceId=t,this.sequence.play(i,s.from,s.to)},play(t=0,e=1,s=1){this.sequence.play(s,t,e)},pause(){this.sequence.pause()},goToFrame(t){this.sequence.goToFrame(t),this.sequence.pauseAtFrame(t)}},de="#define GLSLIFY 1\n#define CONTAIN 0\n#define COVER 1\nvec2 UVResize(vec2 uvBase,vec2 resolution,vec2 aspect,vec2 scale,int fit){vec2 st=resolution/aspect;float r=fit==COVER ? max(st.x,st.y): min(st.x,st.y);vec2 uv=uvBase;uv-=vec2(0.5);uv*=st;uv*=1.0/r;uv*=1.0/scale;uv+=vec2(0.5);return uv;}float crop(vec2 st,vec2 offs){return step(st.x-offs.x,1.0)*step(0.0+offs.x,st.x)*step(st.y,1.0-offs.y)*step(0.0+offs.y,st.y);}float crop(vec2 st){return step(st.x,1.0)*step(0.0,st.x)*step(st.y,1.0)*step(0.0,st.y);}vec4 getSpriteAtFrame(sampler2D tex,vec2 uv,vec4 frame,vec2 size){vec4 f=frame;f.xz/=size.x;f.yw/=size.y;vec2 uvSprite=uv;uvSprite.y=(1.0-f.w)-f.y+(uvSprite.y*f.w);uvSprite.x=f.x+(uvSprite.x*f.z);return texture2D(tex,uvSprite);}vec4 getSpriteAtFrame(sampler2D tex,vec2 uv,vec4 frame,vec2 size,float bias){vec4 f=frame;f.xz/=size.x;f.yw/=size.y;vec2 uvSprite=uv;uvSprite.y=(1.0-f.w)-f.y+(uvSprite.y*f.w);uvSprite.x=f.x+(uvSprite.x*f.z);return texture2D(tex,uvSprite,bias);}vec4 getSpriteAtFrame(sampler2D tex,vec2 uv,vec4 frame,vec2 size,vec4 spriteSrcSize,vec2 srcSize){vec4 f=frame;f.xz/=size.x;f.yw/=size.y;vec2 uvSprite=uv;uvSprite.x+=(srcSize.x-spriteSrcSize.x)/srcSize.x;uvSprite.y-=(srcSize.y-spriteSrcSize.y)/srcSize.y;uvSprite.x-=1.0;uvSprite/=spriteSrcSize.zw/srcSize;uvSprite.y+=1.0;vec2 uvCrop=uvSprite;uvSprite.y=(1.0-f.w)-f.y+(uvSprite.y*f.w);uvSprite.x=f.x+(uvSprite.x*f.z);vec4 color=texture2D(tex,uvSprite);color.a*=crop(uvCrop);return color;}",fe=rt,me=`\n\n    varying vec2 vUv;\n\n    uniform sampler2D uTexture;\n    uniform float uAlpha;\n\n    uniform float uRes;\n    uniform vec2 uResTex;\n\n    uniform vec4 uFrame;\n    uniform vec2 uSourceSize;\n    uniform vec4 uSpriteSourceSize;\n\n    #ifdef USE_GRADIENTMAPPING\n\t    uniform sampler2D gradientMap;\n    #endif\n\n    ${de}\n\n    void main() {\n        vec2 st;\n        #ifdef USE_SIZING\n            st = UVResize(vUv, vec2(uRes), uResTex, vec2(1.)) ;\n        #else\n            st = vUv;\n        #endif\n\n        vec4 tDiffuse;\n        #ifdef USE_ATLAS\n            #ifdef USE_TRIM\n                tDiffuse = getSpriteAtFrame(uTexture, st, uFrame, uResTex, uSpriteSourceSize, uSourceSize);\n            #else\n                tDiffuse = getSpriteAtFrame(uTexture, st, uFrame, uResTex);\n            #endif\n        #else\n            discard;\n        #endif\n\n        float a = tDiffuse.a;\n\n        #ifdef USE_PREMULTIPLYALPHA\n            tDiffuse.rgb /= a;\n        #endif\n\n        a *= uAlpha;\n\n        if(a < 0.1) { discard; }\n\n        gl_FragColor = vec4(tDiffuse.rgb, a);\n    }`;class ve extends D{constructor(t,e={}){super(t=Object.assign({vertexShader:fe,fragmentShader:me,type:"SpriteSimpleMaterial",transparent:!0},t));const s={uTexture:{type:"t",value:e.map},uAlpha:{type:"f",value:1},uFrame:{type:"v4",value:e.frame||[]},uSourceSize:{type:"v2",value:e.sourceSize||[]},uSpriteSourceSize:{type:"v4",value:e.spriteSourceSize||[]},uRes:{type:"f",value:1},uResTex:{type:"v2",value:[]},gradientMap:{type:"t",value:e.gradientMap}};this.defines={USE_ATLAS:!!e.useAtlas,USE_SIZING:!!e.useSizing,USE_GRADIENTMAPPING:!!e.useGradientMap,USE_PREMULTIPLYALPHA:!!e.usePremultiplyalpha,USE_TRIM:!!e.useTrim},this.uniforms={...s,...this.uniforms},ot(this,s)}set frame(t){this.uFrame=t}}class ye extends o{constructor(){super(...arguments),e(this,"options",{useTrim:!0}),e(this,"props",{})}async onSetup(){const{gltfRef:t,maxLayers:e,useTrim:s}=this.options,{size:i,frame:n,atlas:r,sourceSize:o,spriteSourceSize:a}=this.currentFrame,l=this.mesh=t;l.matrixAutoUpdate=!1,l.layers.set(lt.MAIN),l.updateMatrix();const{order:c}=l.userData;l.material=new ve({fragmentShader:`\n\n        varying vec2 vUv;\n        uniform sampler2D uTexture;\n        uniform float uAlpha;\n\n        uniform vec2 uRes;\n        uniform vec2 uResTex;\n        uniform vec4 uFrame;\n        uniform vec2 uSourceSize;\n        uniform vec4 uSpriteSourceSize;\n        ${de}\n        ${U}\n        void main() {\n            vec2 st = vUv;\n                 st = scale(st, vec2(1., -1.)); // flip y bc of blender\n            vec4 tDiffuse = getSpriteAtFrame(uTexture, st, uFrame, uResTex, uSpriteSourceSize, uSourceSize);\n            float a = tDiffuse.a;\n            vec3 color = tDiffuse.rgb;\n                //  color.rgb /= a;\n            gl_FragColor = vec4(color.rgb, a);\n        }`,uniforms:{uResTex:{value:et(i)},uFrame:{value:n?et(n):null},uSourceSize:{value:s?et(o):[]},uSpriteSourceSize:{value:s?et(a):[]}},side:_},{map:r,useAtlas:n,useTrim:s}),n&&ue(l,o),c&&(l.material.depthWrite=l.material.depthTest=!1,l.renderOrder=e-c),this.props.aspect=[o.w,o.h]}onEnter(){this.playSequence("default")}whileEnter(){this.sequence.tick()}onFrame(t){const e=this.frames[t],{mesh:s}=this;s.material.uTexture=e.atlas,s.material.uResTex=et(e.size),s.material.uSourceSize=et(e.sourceSize),s.material.uSpriteSourceSize=et(e.spriteSourceSize),s.material.frame=et(e.frame)}}tt(ye,[ut,pe]);class ge extends D{constructor({uniforms:t={},vs:s=rt,fs:i=at,options:n={}}={}){Object.keys(t).forEach((e=>{t[e]={value:t[e]}})),super({uniforms:t,vertexShader:s,fragmentShader:i}),e(this,"options",{name:"CustomMaterial",transparent:!0}),this.options={...this.options,...n},this.type=this.options.name,this.extensions.derivatives=!0,Object.keys(this.options).forEach((t=>this[t]=this.options[t])),ot(this)}}export{ae as B,ge as C,Mt as G,Bt as H,ft as S,Kt as T,pe as W,Ot as a,Qt as b,ee as c,re as d,oe as e,ue as f,wt as g,kt as h,ye as i,ve as j,bt as k,te as l,de as m,Tt as n,Yt as o,jt as p,Gt as q,Ft as r,Ut as s,Lt as t,ie as u,St as w};
